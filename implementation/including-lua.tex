\section{Including PHP in Lua}\label{including-lua}

\todo[inline]{Callbacks!? and explain why Array returned}

In order to pass the reurn values of PHP functions to Lua, functionality provided by Scribunto was used. \\
The functions accessible by the Lua code are declared in the class \texttt{Scribunto\char`_LuaArticlePlaceholderLibrary}. This class extends \texttt{Scribunto\char`_LuaLibraryBase} in order to register the Lua interface. \\
To get the image property set in \texttt{LocalSettings.php}, the globale variable \texttt{\$wgArticlePlaceholderImageProperty} is wrapped in an array and returned in the function \texttt{getImageProperty()}. Lua functions can have multiple return values \citep{luabook:01}, thus Scribunto needs an array in order to model that. \\
In Lua, these PHP callbacks are copied from \texttt{mw\char`_interface} to the local variable \texttt{php}. From this variable the PHP functions in \texttt{Scribunto\char`_LuaArticlePlaceholderLibrary} can be invoked. Therefore the image property ID can now be used in Lua as well by invoking \texttt{getImageProperty()} in \texttt{mw.ext.articleplaceholder.entityRenderer}. \\
Getting the array with the ordered properties requires a service, the \texttt{ArticlePlaceholderService}.It returns an instance of iteself. It's function \texttt{getPropertyOrderProvider()} returns an instance of the \texttt{PropertyOrderProvider} described in Chapter~\ref{ordering-stat}: \nameref{ordering-stat}. This follows the \textit{Singelton pattern}, which enforces, according to \citet{designpattern}, ``that only one instance of a class will be created''.
In \texttt{Scribunto\char`_LuaArticlePlaceholderLibrary} in the function \texttt{Scribunto\char`_LuaArticlePlaceholderLibrary} this service is called and the associative array of ordered properties is returned.\\
Similar to the image property, the function can be invoked in the Lua module.
